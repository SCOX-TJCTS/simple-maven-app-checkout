pipeline{
  agent any
  environment {
    RELEASENAME="Pipeline Publish SSH testing"
  }

  tools {
    jdk 'Amazon Corretto 8'
  }
  stages{
     stage ("Build / Package"){
            steps{
                    sh "mvn clean package"
                    archiveArtifacts artifacts: 'target/my-app-1.0-SNAPSHOT.jar', followSymlinks: false
              }  
        }
        
     stage ("Alternate Branch"){
     when { branch "*/testing"}
            steps{
                 sh '$JAVA_HOME/bin/java -version'   
              }  
        }   
     stage('SSH transfer') {
        steps([$class: 'BapSshPromotionPublisherPlugin']) {
            sshPublisher(
                continueOnError: false, failOnError: true,
                publishers: [
                    sshPublisherDesc(
                        configName: "tjcts80_test",
                        verbose: true,
                        transfers: [
                            sshTransfer(sourceFiles: "simple-maven-app/target/my-app-1.0-SNAPSHOT.jar",)])])
            }
        }
    }
  }
